<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Catégorie -->
    <record id="module_parckotech_category" model="ir.module.category">
        <field name="name">ParckoTech</field>
        <field name="description">Gestion de parc informatique</field>
        <field name="sequence">50</field>
    </record>

    <!-- Groupes -->
    <record id="group_parckotech_user" model="res.groups">
        <field name="name">Utilisateur</field>
        <field name="category_id" ref="module_parckotech_category"/>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
    </record>

    <record id="group_parckotech_manager" model="res.groups">
        <field name="name">Responsable</field>
        <field name="category_id" ref="module_parckotech_category"/>
        <field name="implied_ids" eval="[(4, ref('group_parckotech_user'))]"/>
        <field name="users" eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"/>
    </record>

    <!-- Groupe Admin global -->
    <record id="group_parckotech_admin_global" model="res.groups">
        <field name="name">Admin ParckoTech</field>
        <field name="category_id" ref="module_parckotech_category"/>
        <field name="implied_ids" eval="[(4, ref('group_parckotech_manager'))]"/>
    </record>

    <!-- Règle multi-société (matériel) -->
    <record id="parckotech_rule_multi_company" model="ir.rule">
        <field name="name">ParckoTech – Multi-société</field>
        <field name="model_id" ref="model_parckotech_materiel"/>
        <field name="domain_force">['|', ('company_id','=',False), ('company_id','in', company_ids)]</field>
    </record>

    <!-- Filtrage par site désactivé en l'absence de allowed_site_ids -->
    <record id="parckotech_rule_site_pack" model="ir.rule">
        <field name="name">Pack – filtrage site (désactivé)</field>
        <field name="model_id" ref="model_parckotech_pack_informatique"/>
        <field name="groups" eval="[(4, ref('group_parckotech_user'))]"/>
        <!-- autorise tout pour l'instant -->
        <field name="domain_force">[(1,'=',1)]</field>
    </record>

    <record id="parckotech_rule_site_incident" model="ir.rule">
        <field name="name">Incident – filtrage site (désactivé)</field>
        <field name="model_id" ref="model_parckotech_incident"/>
        <field name="groups" eval="[(4, ref('group_parckotech_user'))]"/>
        <field name="domain_force">[(1,'=',1)]</field>
    </record>

    <record id="parckotech_rule_site_intervention" model="ir.rule">
        <field name="name">Intervention – filtrage site (désactivé)</field>
        <field name="model_id" ref="model_parckotech_intervention"/>
        <field name="groups" eval="[(4, ref('group_parckotech_user'))]"/>
        <field name="domain_force">[(1,'=',1)]</field>
    </record>
</odoo>
